<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.7.4">Jekyll</generator><link href="http://alemangui.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="http://alemangui.github.io/" rel="alternate" type="text/html" /><updated>2020-08-21T10:11:07+02:00</updated><id>http://alemangui.github.io/</id><title type="html">Alejandro Mantecón Guillén</title><subtitle>Le blog d'Alejandro Mantecón Guillén</subtitle><entry><title type="html">Les biais de l’intelligence artificielle</title><link href="http://alemangui.github.io/biais-intelligence-artificielle" rel="alternate" type="text/html" title="Les biais de l'intelligence artificielle" /><published>2020-05-09T00:00:00+02:00</published><updated>2020-05-09T00:00:00+02:00</updated><id>http://alemangui.github.io/biais-intelligence-artificielle</id><content type="html" xml:base="http://alemangui.github.io/biais-intelligence-artificielle">&lt;p&gt;Le 10 mars 2016, le meilleur joueur de go du monde, Lee Sedol, affrontait AlphaGo, un programme informatique développé par Google DeepMind. S’attaquer au Go est une tâche particulièrement difficile pour l’intelligence artificielle (IA) car, à différence des échecs, les ordinateurs ne sont pas capables de calculer toutes les combinaisons possibles du jeu (plus nombreuses que le nombre d’atomes dans l’univers). Dès lors, pour s’imposer face à son rival, AlphaGo devait faire preuve d’intuition et créativité : deux qualités considérées essentiellement humaines.&lt;/p&gt;

&lt;p&gt;Au bout d’une heure et demie de jeu, lors du 37ème tour, AlphaGo joue un coup déconcertant : la position O10. &lt;a href=&quot;https://youtu.be/l-GsfyVCBu0?t=4692&quot;&gt;Les commentateurs&lt;/a&gt; envisagent la possibilité qu’il s’agisse d’une erreur. Les spécialistes  ont du mal à croire cette décision amplement considérée comme mauvaise. Néanmoins, après trois heures et demie de jeu, AlphaGo bat Lee Sedol, confirmant ainsi le génie derrière ce mouvement. Le coup 37 est rentré dans la liste des moments phares de l’IA, prouvant sa capacité à développer une créativité dépassant celle de son homologue humain.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/commentary_go.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;Les commentateurs du match entre Lee Sedol et AlphaGo surpris par le mouvement 37 &lt;a href=&quot;https://www.youtube.com/watch?v=l-GsfyVCBu0&amp;amp;feature=youtu.be&amp;amp;t=4692&quot;&gt;Vidéo&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Cette aptitude a propulsé l’IA vers de nombreux domaines. Le &lt;a href=&quot;https://www.credigo.fr/actualites/ia-intelligence-artificielle-et-secteur-bancaire.html&quot;&gt;secteur bancaire&lt;/a&gt; l’utilise pour évaluer le risque d’accorder un crédit. L’industrie médicale investit dans des &lt;a href=&quot;https://deepmind.com/blog/announcements/deepmind-health-joins-google-health&quot;&gt;systèmes aidant la détection des maladies&lt;/a&gt;. Des &lt;a href=&quot;https://www.westmidlands-pcc.gov.uk/wp-content/uploads/2019/12/27112019-EC-Item-3-Briefing-Note-NDAS-MSV.pdf&quot;&gt;systèmes de renseignement policier&lt;/a&gt; basés sur l’IA voient le jour. Dans le domaine militaire, une véritable course aux &lt;a href=&quot;https://globalnews.ca/news/4125382/google-pentagon-ai-project-maven/&quot;&gt;armements basés sur l’IA&lt;/a&gt; se déroule en ce moment. Mais aussi en &lt;a href=&quot;https://www.justice-predictive.com/index.php/2-non-categorise/24-justice-predictive-de-l-idee-a-la-realite&quot;&gt;droit&lt;/a&gt;, &lt;a href=&quot;https://www.decision-achats.fr/Thematique/it-digital-1233/Breves/intelligence-artificielle-impose-dans-secteur-logistique-330491.htm&quot;&gt;logistique&lt;/a&gt;, &lt;a href=&quot;https://www.meta-media.fr/2019/05/23/lintelligence-artificielle-est-une-alliee-pour-la-presse-et-les-journalistes.html&quot;&gt;journalisme&lt;/a&gt; et même &lt;a href=&quot;https://fr.wikipedia.org/wiki/Portrait_d%27Edmond_de_Belamy&quot;&gt;art&lt;/a&gt;, l’IA est un bon élève devenu omniprésente.&lt;/p&gt;

&lt;p&gt;Néanmoins, éduquer une machine n’est pas chose aisée et les enseignants chargés de cette tâche sommes nous tous. Nous, qui sommes si prônes à une multitude d’irrationalités. Nous, qui entretenons des dogmes remarquablement résistants aux faits qui les contredisent. Nous qui, en délégant tant d’aspects de nos vies aux nouvelles technologies, prenons le risque de pérenniser nos biais.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;L'ordinateur a appris à partir des humains comment discriminer, et il a fait le travail avec une efficacité à couper le souffle&lt;/p&gt;
&lt;cite&gt;- Cathy O'Neil &lt;a href=&quot;https://weaponsofmathdestructionbook.com/&quot;&gt;« Weapons of Math Destruction »&lt;/a&gt;&lt;/cite&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;une-ia-peut-elle-discriminer-&quot;&gt;Une IA peut-elle discriminer ?&lt;/h2&gt;

&lt;h3 id=&quot;microsoft-tay&quot;&gt;Microsoft Tay&lt;/h3&gt;

&lt;p&gt;En mars 2016, Microsoft a mis sur Twitter un agent conversationnel basé sur l’IA appelé Tay. Tay avait comme objectif de développer son langage à la suite des discussions avec des êtres humains.&lt;/p&gt;

&lt;p&gt;Après seulement 24 heures, Tay tenait des propos racistes, misogynes et négationnistes tellement graves que &lt;a href=&quot;https://www.20minutes.fr/high-tech/1813579-20160325-microsoft-debranche-robot-devenu-fou-interrompre-tweets-racistes-pro-nazis&quot;&gt;Microsoft a dû la débrancher&lt;/a&gt;. Après quelques ajustements, une deuxième tentative a été faite une semaine plus tard avec le même résultat. Microsoft a jeté l’éponge dénonçant un “effort coordonné de plusieurs utilisateurs pour abuser des compétences de Tay”.&lt;/p&gt;

&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;&amp;quot;Tay&amp;quot; went from &amp;quot;humans are super cool&amp;quot; to full nazi in &amp;lt;24 hrs and I&amp;#39;m not at all concerned about the future of AI &lt;a href=&quot;https://t.co/xuGi1u9S1A&quot;&gt;pic.twitter.com/xuGi1u9S1A&lt;/a&gt;&lt;/p&gt;&amp;mdash; gerry (@geraldmellor) &lt;a href=&quot;https://twitter.com/geraldmellor/status/712880710328139776?ref_src=twsrc%5Etfw&quot;&gt;March 24, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;p&gt;La nature des propos de Tay ne laissent personne indifférent. Néanmoins, on peut probablement se dire que l’impact de cet agent conversationnel n’est pas immense. Après tout, en ce qui concerne les comptes tenant des propos inacceptables, Twitter n’en est pas à un près.&lt;/p&gt;

&lt;p&gt;En revanche, des biais présents dans des domaines tels que le recrutement ou le droit pénal peuvent avoir un impact immense dans la vie des gens et en conséquence dans notre société tout entière.&lt;/p&gt;

&lt;h3 id=&quot;les-systèmes-de-recrutement&quot;&gt;Les systèmes de recrutement&lt;/h3&gt;

&lt;p&gt;En 2014, Amazon a conçu en secret une IA visant à automatiser la sélection des CVs pour fluidifier leurs processus RH. Pour apprendre, le système s’est basé sur dix ans de données de recrutement dans un environnement majoritairement masculin. Ainsi, il n’est pas surprenant que l’IA déduise que les candidats masculins étaient préférables. L’IA pénalisait même l’utilisation du mot “femme” : un CV contenant la mention d’un “club de jeu échecs pour femme” se voyait &lt;a href=&quot;http://www.slate.fr/story/168413/amazon-abandonne-intelligence-artificielle-sexiste&quot;&gt;déprécier automatiquement&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Malgré des modifications apportées pour contrer ce biais, le projet a fini par être abandonné par crainte que d’autres moyens de discrimination soient adoptés.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/amazon-recruitment.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Amazon est loin d’être la seule entreprise dans ce cas de figure. Hilton (169.000 employés), Delta (86.564) et Goldman Sachs (36.600) font aussi appel à ces technologies pour automatiser une partie de leur processus d’embauche. Des fois, des étapes de &lt;a href=&quot;https://skillroads.com/blog/ai-and-facial-recognition-are-game-changers-for-recruitment&quot;&gt;reconnaissance faciale ou auditive&lt;/a&gt; peuvent faire partie du processus, ouvrant la porte à davantage d’axes discriminatoires. Ces systèmes étant des boîtes noires, certaines ONGs s’inquiètent sur la difficulté de poursuivre un employeur pour discrimination à la suite d’une embauche automatisé.&lt;/p&gt;

&lt;h3 id=&quot;le-domaine-pénal-laissé-aux-ias&quot;&gt;Le domaine pénal laissé aux IAs&lt;/h3&gt;

&lt;p&gt;En avril 2017, &lt;a href=&quot;https://www.lebigdata.fr/compas-algorithme-prison-0305&quot;&gt;Eric L. Loomis a été condamné&lt;/a&gt; à six ans de prison aux États-Unis par l’algorithme &lt;a href=&quot;https://en.wikipedia.org/wiki/COMPAS_(software)&quot;&gt;Compas&lt;/a&gt;. L’IA a déterminé que l’individu présentait un risque élevé de récidive. Développé par une entreprise privée et protégé sous le secret commercial, personne n’est autorisé à examiner le processus par lequel l’algorithme est arrivé à cette conclusion.&lt;/p&gt;

&lt;p&gt;Les données d’entraînement pour Compas sont particulièrement inquiétants. Aux États-Unis, les Afro-Américains représentent 13 % de la population et constituent néanmoins &lt;a href=&quot;https://en.wikipedia.org/wiki/Incarceration_in_the_United_States&quot;&gt;40 % des incarcérés&lt;/a&gt;. De plus, à crimes et délits égaux, les noirs sont bien plus souvent condamnés que les blancs. Dans &lt;a href=&quot;https://fr.wikipedia.org/wiki/Capital_et_Id%C3%A9ologie&quot;&gt;Capital et Idéologie&lt;/a&gt;, Thomas Piketty relève qu’environ 5 % des hommes adultes noirs sont en prison aux États-Unis, soit un taux comparable à celui l’ensemble de la population en URSS en 1953, à la mort de Staline.&lt;/p&gt;

&lt;p&gt;Sans grande surprise, les préjuges raciaux existants ont été renforcés : Compas considère qu’un homme noir sans antécédents a deux fois plus de chances de commettre un nouveau délit qu’un blanc ayant déjà un casier judiciaire.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/pro-publica.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;&lt;a href=&quot;https://www.propublica.org/article/machine-bias-risk-assessments-in-criminal-sentencing&quot;&gt;L’investigation menée par Julia Angwin&lt;/a&gt; met en évidence les biais de l’IA Compas&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Pour jeter de l’huile sur le feu, en adoptant ces biais, Compas est devenu très peu fiable. Une &lt;a href=&quot;https://www.propublica.org/article/machine-bias-risk-assessments-in-criminal-sentencing&quot;&gt;investigation menée par Julia Angwin&lt;/a&gt; et publié par ProPublica montre que seulement 20 % des personnes considérées en risque de récidive finissaient par commettre un nouveau crime. Des &lt;a href=&quot;https://www.sciencesetavenir.fr/high-tech/intelligence-artificielle/pour-predire-la-recidive-l-interet-limite-des-algorithmes_120238&quot;&gt;chercheurs de Dartmouth College&lt;/a&gt; ont mené une expérience prouvant que les prédictions fournies par Compas n’étaient pas meilleures que celles faites par des personnes sans formation juridique.&lt;/p&gt;

&lt;p&gt;Malgré ceci, des initiatives similaires ont apparu ces dernières années ailleurs dans le monde, comme la &lt;a href=&quot;https://www.clubic.com/technologies-d-avenir/intelligence-artificielle/actualite-848035-police-britannique-travaille-ia-devancer-crime.html&quot;&gt;National Data Analytics Solution&lt;/a&gt; (NDAS) en Grande Bretagne.&lt;/p&gt;

&lt;h3 id=&quot;la-liste-est-longue&quot;&gt;La liste est longue&lt;/h3&gt;

&lt;p&gt;Énumérer tous les cas où la vie des gens se voit affectée par des algorithmes biaisés est une tâche d’envergure qui dépasse la portée de cet article. Des &lt;a href=&quot;https://www.lemonde.fr/pixels/article/2017/04/25/l-application-a-succes-faceapp-qui-rend-les-gens-sexys-accusee-de-racisme_5117244_4408996.html&quot;&gt;applications qui éclairaient les visages&lt;/a&gt; pour les “rendre plus beaux” suite à un manque de diversité dans les données d’entraînement, des algorithmes qui &lt;a href=&quot;https://theconversation.com/did-artificial-intelligence-deny-you-credit-73259&quot;&gt;refusent des prêts bancaires&lt;/a&gt; sans pouvoir justifier leur décision, des &lt;a href=&quot;https://www.marianne.net/monde/au-pays-bas-la-justice-met-un-coup-d-arret-au-flicage-technologique-des-pauvres&quot;&gt;systèmes de détection de fraude&lt;/a&gt; aux aides sociales qui défavorisent les populations les plus pauvres : la liste est décidément trop longue.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/faceapp.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot; style=&quot;margin-top: 10px;&quot;&gt;FaceApp décide de blanchir les photos à cause des biais dans les données d’entraînement. Image de Jessica Lea / DFID / CC BY 2.0&lt;/small&gt;&lt;/p&gt;

&lt;h2 id=&quot;quest-ce-quon-peut-faire-&quot;&gt;Qu’est-ce qu’on peut faire ?&lt;/h2&gt;

&lt;p&gt;Les algorithmes n’ayant pas des biais inhérents, on peut déduire que le problème n’est pas l’intelligence artificielle elle-même, mais plutôt nos données historiques. Qui plus est, en détenant une technologie capable de faire abstraction des imprécisions du cerveau humain, on a potentiellement un allié important contre la discrimination. Certes, nous l’avons plutôt transformé en outil d’exclusion, mais on peut encore ajuster le guidon.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Grossièrement, [les IA] analysent le passé pour prédire le futur. Une IA regarde toujours dans le rétroviseur. &lt;/p&gt;
&lt;cite&gt;- Pierre Boullier, fondateur de l’école Simplon&lt;/cite&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;la-transparence&quot;&gt;La transparence&lt;/h3&gt;

&lt;p&gt;Tant que le parcours qui mène une IA à prendre une décision ne soit pas auditable, aucune partie prenante n’acceptera la responsabilité de ses effets nocifs. Tant que le fonctionnement d’un algorithme ne soit pas explicable, les ajustements nécessaires pour contrer les préjugés ne pourront pas s’effectuer. Malheureusement, la transparence est loin d’être la règle aujourd’hui.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;George Akerlof a montré que si un marché devenait opaque, il risquait de s'effondrer. C'est ce qui pourrait arriver à l'IA si on ne parvient pas à lui injecter plus de transparence.&lt;/p&gt;
&lt;cite&gt;- Patrick Waelbroeck, professeur à Télécom ParisTech&lt;/cite&gt;
&lt;/blockquote&gt;

&lt;p&gt;Plusieurs initiatives ont été créées à ce sujet. L’Union Européenne a &lt;a href=&quot;https://www.europarl.europa.eu/doceo/document/TA-8-2019-0081_FR.html&quot;&gt;adopté une résolution&lt;/a&gt; soulignant la nécessité de garantir, dès la conception, l’explicabilité des algorithmes. L’OCDE a publié des &lt;a href=&quot;https://www.oecd.org/fr/science/quarante-deux-pays-adoptent-les-nouveaux-principes-de-l-ocde-sur-l-intelligence-artificielle.htm&quot;&gt;principes sur l’IA&lt;/a&gt; établissant l’importance d’assurer la transparence des informations afin de ce que les résultats puissent être contestés. La société de recherche à but non-lucratif &lt;a href=&quot;https://openai.com/&quot;&gt;OpenAI&lt;/a&gt; a été créée pour développer de l’IA open source. Bien d’autres organisations existent aujourd’hui avec des buts similaires.&lt;/p&gt;

&lt;p&gt;Quelques sous-disciplines de l’IA - tels que le deep learning et les algorithmes génétiques - sont naturellement opaques. De la recherche pour rendre ces algorithmes compréhensibles a donné naissance à la &lt;a href=&quot;https://en.wikipedia.org/wiki/Explainable_artificial_intelligence&quot;&gt;XAI&lt;/a&gt; (eXplainable Artificial Intelligence), permettant d’éliminer les obstacles techniques pour avoir des algorithmes plus justes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/elements-of-ai.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot; style=&quot;margin-top: 10px;&quot;&gt;Hanna Hagström et Teemu Ross, les concepteurs du MOOC Elements of AI. Image de Aki Rask / Reaktor&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Ces initiatives doivent être accompagnées d’une société formée aux enjeux de l’IA pour que les citoyens puissent prendre part au débat public. L’Université de Helsinki, en partenariat avec le cabinet Reaktor, a lancé la formation ouverte et gratuite &lt;a href=&quot;https://course.elementsofai.com/&quot;&gt;“Elements of AI”&lt;/a&gt; avec l’objectif de former 1 % de la population européenne aux bases de l’IA. Cette formation sera bientôt traduite dans &lt;a href=&quot;https://www.elementsofai.com/eu2019fi&quot;&gt;toutes les langues européennes&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;lamélioration-continue&quot;&gt;L’amélioration continue&lt;/h3&gt;

&lt;p&gt;Il faut néanmoins se rendre à l’évidence : il est impossible de rendre les données impartiales. De plus, régler des paramètres une seule fois ne suffit pas. Par exemple, en enlevant le paramètre de la couleur de peau, Compas pourrait continuer à discriminer en trouvant des variables corrélés tels que l’adresse de l’accusé.&lt;/p&gt;

&lt;p&gt;Il est donc important d’intégrer un processus continu d’audit et amélioration continue pour paramétrer en permanence nos systèmes. Pour Serge Abiteboul, chercheur à l’ENS Paris, ces contrôles peuvent prendre la forme des rapports chiffrés réguliers et audits du code. La chercheuse Gwendal Legrand suggère plutôt que le contrôle des algorithmes soit intégré aux algorithmes eux-mêmes.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;L’enjeu est d’assigner le bon poids à chacune des variables que l’on assigne à ces données afin de produire les résultats les plus justes possibles.&lt;/p&gt;
&lt;cite&gt;- Pierre Boullier, fondateur de l’école Simplon&lt;/cite&gt;
&lt;/blockquote&gt;

&lt;p&gt;Des actions allant dans cette direction commencent à apparaître. À Toulouse, la startup &lt;a href=&quot;http://fdu-label.com/fr/&quot;&gt;Maathics&lt;/a&gt; a été crée pour détecter, quantifier et corriger les sources de discrimination dans les algorithmes. Elle permet aux entreprises de se certifier Fair Data Use : un label qui assure un audit périodique pour repérer des failles dans les systèmes d’IA qui pourraient provoquer des discriminations.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/maathics.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot; style=&quot;margin-top: 10px;&quot;&gt;Anna Choury, PDG de Maathics. Image d’&lt;a href=&quot;https://twitter.com/ioctavia/status/1044868551612542978&quot;&gt;Octavia Ivan&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;h3 id=&quot;le-cadre-légal&quot;&gt;Le cadre légal&lt;/h3&gt;

&lt;p&gt;Un cadre légal avec des règles précises et des conséquences réelles en cas de non-conformité est essentiel.&lt;/p&gt;

&lt;p&gt;Le 5 février dernier, le tribunal de La Haye a &lt;a href=&quot;https://www.marianne.net/monde/au-pays-bas-la-justice-met-un-coup-d-arret-au-flicage-technologique-des-pauvres&quot;&gt;interdit au gouvernement hollandais d’utiliser SyRI&lt;/a&gt;, un logiciel de détection de fraude aux aides sociales. L’administration avait refusé de dévoiler le code de ce système qui défavorisait de façon disproportionnée les populations les plus pauvres. Ceci établit un précédent légal fort pour les prochaines affaires.&lt;/p&gt;

&lt;p&gt;Le 19 février, la Commission Européenne a présenté sa &lt;a href=&quot;https://www.lesechos.fr/tech-medias/intelligence-artificielle/intelligence-artificielle-bruxelles-promet-un-encadrement-bien-reel-1173157&quot;&gt;stratégie pour l’intelligence artificielle&lt;/a&gt;. Une approche proportionnelle a été prise : plus l’utilisation des algorithmes sera dangereuse pour la santé, la sécurité ou les droits fondamentaux, plus les règles seront strictes. Leur &lt;a href=&quot;https://ec.europa.eu/info/sites/info/files/commission-white-paper-artificial-intelligence-feb2020_fr.pdf&quot;&gt;livre blanc&lt;/a&gt; établit aussi que les systèmes devront “être transparents, traçables et garantir un contrôle humain”. La législation plus détaillée sera présentée fin 2020.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/leyen.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot; style=&quot;margin-top: 10px;&quot;&gt;Ursula von der Leyen - Commission Européenne. Image de Dursun Aydemir - Agencia Anadolu&lt;/small&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;
Les pouvoirs publics doivent être en mesure de tester et de certifier les données utilisées par les algorithmes pour garantir le respect des droits fondamentaux, notamment la non-discrimination.
&lt;/p&gt;
&lt;cite&gt;- &lt;a href=&quot;https://ec.europa.eu/info/sites/info/files/commission-white-paper-artificial-intelligence-feb2020_fr.pdf&quot;&gt;Livre blanc&lt;/a&gt; de la Commission Européenne sur l'intelligence artificielle&lt;/cite&gt;
&lt;/blockquote&gt;

&lt;p&gt;Cette réglementation s’ajoutera au Règlement Européen sur la Protection des données à caractère personnel (&lt;a href=&quot;https://www.cnil.fr/fr/reglement-europeen-protection-donnees&quot;&gt;RGPD&lt;/a&gt;), ainsi que la loi Informatique et Libertés (&lt;a href=&quot;https://www.cnil.fr/fr/la-loi-informatique-et-libertes&quot;&gt;LIL&lt;/a&gt;). Ces lois européennes imposent déjà des restrictions telles que le principe de minimisation (les données personnelles doivent se limiter à ce qui est strictement nécessaire) et ceux d’explicabilité et d’intelligibilité des algorithmes.&lt;/p&gt;

&lt;h2 id=&quot;ce-nest-pas-trop-tard&quot;&gt;Ce n’est pas trop tard&lt;/h2&gt;

&lt;p&gt;L’intelligence artificielle a le potentiel de devenir soit un allié de poids pour l’humanité soit un outil dangereux et discriminatoire. Nous vivons un moment crucial où l’on est encore en mesure de choisir, en tant que société, quel chemin sera pris.&lt;/p&gt;

&lt;p&gt;L’implication citoyenne, par le biais du support aux organisations, la prise de connaissance dans le sujet et l’exercice du droit de vote est essentiel pour prendre cette décision. Ne laissons pas l’apathie le faire à notre place.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/protest-ia.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot; style=&quot;margin-top: 10px;&quot;&gt;Photo prise par Waldemar Brandt, Unsplash&lt;/small&gt;&lt;/p&gt;</content><author><name></name></author><category term="Société" /><category term="IA" /><summary type="html">Cette nouvelle technologie devenue omniprésente renforce nos préjugés. Comment ne pas pérenniser nos déviations de jugement ?</summary></entry><entry><title type="html">Tests automatiques avec autoplay</title><link href="http://alemangui.github.io/tests-automatiques-avec-autoplay" rel="alternate" type="text/html" title="Tests automatiques avec autoplay" /><published>2020-03-25T00:00:00+01:00</published><updated>2020-03-25T00:00:00+01:00</updated><id>http://alemangui.github.io/tests-automatiques-avec-autoplay</id><content type="html" xml:base="http://alemangui.github.io/tests-automatiques-avec-autoplay">&lt;p&gt;Depuis 2017, les différents navigateurs implémentent des fonctionnalités permettant de bloquer le son qui démarre automatiquement. Ceci n’a rien d’étonnant : on a tous vécu la nuisance des vidéos en autoplay qui se cachent parmi les nombreux onglets du navigateur. Néanmoins, pour les développeurs qui se basent de façon légitime sur l’autoplay (notamment pour des jeux vidéos ou applications multimédia), ces restrictions peuvent causer des difficultés.&lt;/p&gt;

&lt;h2 id=&quot;les-tests-chez-pizzicato-js&quot;&gt;Les tests chez Pizzicato JS&lt;/h2&gt;

&lt;p&gt;J’ai rencontré un de ces problèmes dans le cadre du développement de &lt;a href=&quot;https://alemangui.github.io/pizzicato/&quot;&gt;Pizzicato JS&lt;/a&gt;, une librairie visant à simplifier la création et manipulation du son dans le navigateur (&lt;a href=&quot;github.com/alemangui/pizzicato/&quot;&gt;code source ouvert&lt;/a&gt;). Pizzicato compte une batterie de tests automatiques interagissant avec l’API WebAudio. Ces tests sont exécutés en Chrome depuis Travis CI à chaque nouveau commit.&lt;/p&gt;

&lt;p&gt;Avec les versions récentes de Chrome, les tests qui dépendent du son échouent systématiquement :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/failed-build.jpg&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Chrome 80.0.3987 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Linux 0.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Sound actions should trigger &lt;span class=&quot;s1&quot;&gt;'end'&lt;/span&gt; when buffer ended FAILED
	Expected spy endCallback to have been called.
	    at tests/Sound.test.js:270:26

Chrome 80.0.3987 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Linux 0.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Executed 118 of 144 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 FAILED&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0 secs / 2.516 secs&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Chrome 80.0.3987 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Linux 0.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Sound actions should offset upon playing when specified FAILED
	Expected spy endCallback to have been called.
	    at tests/Sound.test.js:287:26

Chrome 80.0.3987 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Linux 0.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Executed 119 of 144 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2 FAILED&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0 secs / 4.527 secs&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;la-politique-autoplay-de-chrome&quot;&gt;La politique Autoplay de Chrome&lt;/h2&gt;

&lt;p&gt;Cet échec n’est pas un mystère : les tests vont à l’encontre de la politique autoplay de Chrome : pas d’audio sans interaction utilisateur. Or, dans un contexte ou les tests automatiques se déroulent dans un processus virtuel au sein de Travis CI, l’interaction utilisateur est impossible.&lt;/p&gt;

&lt;p&gt;Heureusement, on peut lancer Chrome avec une option spéciale pour lui demander de désactiver cette politique :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Chrome &lt;span class=&quot;nt&quot;&gt;--autoplay-policy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no-user-gesture-required&lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Pour intégrer ceci dans Pizzicato, il suffit de modifier le &lt;a href=&quot;https://github.com/alemangui/pizzicato/blob/master/karma.conf.js&quot;&gt;fichier de configuration de Karma&lt;/a&gt;. Au moment de définir les &lt;code class=&quot;highlighter-rouge&quot;&gt;customLaunchers&lt;/code&gt; nous pouvons aussi profiter pour passer des arguments additionnels.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;customLaunchers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nl&quot;&gt;Chrome_travis_ci&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nl&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Chrome'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;flags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;'--no-sandbox'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s1&quot;&gt;'--autoplay-policy=no-user-gesture-required'&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;TravisCI est vert à nouveau.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/successful-build.jpg&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;et-dans-la-vraie-vie-&quot;&gt;Et dans la vraie vie ?&lt;/h2&gt;

&lt;p&gt;Comprendre les conditions qui mènent les navigateurs à bloquer le contenu audio est utile pour que nos utilisateurs puissent profiter du web sans devoir bidouiller des options obscures dans la ligne de commande.&lt;/p&gt;

&lt;h3 id=&quot;chrome&quot;&gt;Chrome&lt;/h3&gt;

&lt;p&gt;Dans Chrome, l’autoplay en muet (volume 0) est permis - d’où les boutons “Tap to unmute” qui apparaissent un peu partout. Sinon, il faut impérativement un de ces scénarios :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;l’utilisateur a interagit avec la page (par ex. en clickant quelque part),&lt;/li&gt;
  &lt;li&gt;l’utilisateur a ajouté le site dans son écran d’accueil ou l’a installé en tant que Progressive Web App, ou&lt;/li&gt;
  &lt;li&gt;le site a un &lt;em&gt;Media Engagement Index&lt;/em&gt; (MEI) suffisant.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ce dernier point peut paraître un peu obscur. Le MEI tente de mesurer à quel point l’usager est habitué à consommer de l’audio/vidéo sur un site particulier. Pour ce faire, Chrome fait le calcul du ratio des visites totales contre les visites incluant une consommation média considéré comme suffisante (çad plus de sept secondes, audio non-muet, onglet actif et taille d’écran supérieure à 200x140).&lt;/p&gt;

&lt;p&gt;Pour les utilisateurs de Chrome, ces stats sont visibles sur &lt;a href=&quot;chrome://media-engagement&quot;&gt;chrome://media-engagement&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/mei.jpg&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;firefox&quot;&gt;Firefox&lt;/h3&gt;

&lt;p&gt;Les règles de Firefox sont similaires à celles de Chrome : l’audio en muet est permis et l’interaction utilisateur est requise pour tout ce qui est audible.&lt;/p&gt;

&lt;p&gt;De plus, Firefox permet l’autoplay si l’utilisateur a déjà donné la permission au site d’accéder à la camera ou le micro. Ceci s’avère utile pour les sites de vidéo-conférence.&lt;/p&gt;

&lt;p&gt;En ce qui concerne les sites “de confiance” Firefox opte pour une approche plus direct. Lorsqu’un site avec autoplay est bloqué, une icône apparaît dans la barre URL. L’usager peut clicker dessus et manuellement indiquer que le site peut faire de l’autoplay sans que le navigateur s’en mêle.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/autoplay-ff.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;Image de &lt;a href=&quot;https://hacks.mozilla.org/2019/02/firefox-66-to-block-automatically-playing-audible-video-and-audio/&quot;&gt;Mozilla&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;h2 id=&quot;ce-nest-pas-fini&quot;&gt;Ce n’est pas fini&lt;/h2&gt;

&lt;p&gt;Les règles autour de l’audio et vidéo sur les navigateurs vont encore évoluer de façon importante dans les années qui viennent. Des discussions autour de l’étendue des restrictions autoplay &lt;a href=&quot;https://bugzilla.mozilla.org/show_bug.cgi?id=1420389&quot;&gt;se déroulent encore&lt;/a&gt;. D’un côté, démarrer des vidéos automatiquement, même sans audio, consomme des données des forfaits potentiellement limités. D’un autre, &lt;a href=&quot;https://www.bleepingcomputer.com/news/google/google-fixes-issue-that-broke-millions-of-web-based-games-in-chrome/&quot;&gt;plein des applications multimédia&lt;/a&gt; dépendent de cette fonctionnalité. En tant que développeurs, il faudra suivre de près cette évolution.&lt;/p&gt;

&lt;h2 id=&quot;en-savoir-plus&quot;&gt;En savoir plus&lt;/h2&gt;

&lt;p&gt;Malheureusement, la plupart de la documentation autour des politiques autoplay des navigateurs est exclusivement en anglais. Voici quelques exemples :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Détails sur la &lt;a href=&quot;https://developers.google.com/web/updates/2017/09/autoplay-policy-changes#mei&quot;&gt;politique autoplay Chrome&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Article de Chris Pearce concernant &lt;a href=&quot;https://hacks.mozilla.org/2019/02/firefox-66-to-block-automatically-playing-audible-video-and-audio/&quot;&gt;l’autoplay sur Firefox&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Article de Kevin Decker sur &lt;a href=&quot;https://webkit.org/blog/7734/auto-play-policy-changes-for-macos/&quot;&gt;l’autoplay sur Safari&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Documentation de la politique &lt;a href=&quot;https://docs.microsoft.com/fr-fr/microsoft-edge/dev-guide/browser-features/autoplay-policies&quot;&gt;autoplay sur Edge&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="Développement" /><category term="JS" /><summary type="html">Les navigateurs implémentent des fonctionnalités permettant de bloquer le contenu audio qui démarre automatiquement. Comment s'en sortir en tant que développeur ?</summary></entry><entry><title type="html">Apple et le droit à la réparation</title><link href="http://alemangui.github.io/apple-et-le-droit-a-la-reparation" rel="alternate" type="text/html" title="Apple et le droit à la réparation" /><published>2020-02-26T00:00:00+01:00</published><updated>2020-02-26T00:00:00+01:00</updated><id>http://alemangui.github.io/apple-et-le-droit-a-la-reparation</id><content type="html" xml:base="http://alemangui.github.io/apple-et-le-droit-a-la-reparation">&lt;p&gt;De nos jours, la sensibilité des consommateurs à l’égard des questions écologiques et sociales pèse lourd dans la balance en faveur de la réparation et contre l’achat du nouveau. Néanmoins, Apple - une marque souvent perçue comme étant en phase avec son temps - continue de ferrailler contre les initiatives de remise en état de leurs produits.&lt;/p&gt;

&lt;h2 id=&quot;pourquoi-réparer-&quot;&gt;Pourquoi réparer ?&lt;/h2&gt;

&lt;p&gt;Prolonger la durée de vie des objets présente des nombreuses avantages au niveau individuel, sociétal et écologique. Réparer s’avère moins coûteux que racheter un produit neuf, contribue à l’économie local en faisant appel à des artisans et techniciens de proximité, et permet de diminuer notre empreinte écologique. Ce dernier point concerne non seulement les déchets, mais aussi les ressources utilisées lors de la production et le transport de nouveaux produits.&lt;/p&gt;

&lt;p&gt;Pour les appareils électroniques le bilan est lourd. Les minéraux et métaux qui les composent proviennent d’une exploitation minière souvent pointée du doigt pour leurs pratiques polluantes, conditions déplorables pour les employées et &lt;a href=&quot;http://www.leparisien.fr/economie/cobalt-apple-microsoft-ou-google-accuses-de-profiter-du-travail-des-enfants-17-12-2019-8219259.php&quot;&gt;travail des enfants&lt;/a&gt;. Les composants sont manufacturés aux &lt;a href=&quot;https://www.lifewire.com/where-is-the-iphone-made-1999503&quot;&gt;quatre coins du monde&lt;/a&gt; et doivent être transportés plusieurs fois jusqu’au client final, ajoutant à l’empreinte carbone de l’appareil. Finalement, les déchets électroniques - qui d’ailleurs sont les déchets avec &lt;a href=&quot;http://www3.weforum.org/docs/WEF_A_New_Circular_Vision_for_Electronics.pdf&quot;&gt;le plus grand taux de croissance au monde&lt;/a&gt; - sont envoyés dans des pays en voie de développement pour être traités manuellement malgré les éléments toxiques qu’ils contiennent.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/electronic_waste.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;Image d’Andrew McConnell. Copyright : Panos Pictures&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Plus généralement, les associations de protection du consommateur maintiennent qu’une fois l’appareil vendu, il n’appartient plus au constructeur, mais à l’acheteur. Libre à lui de faire ce qu’il veut avec. Les efforts pour empêcher les utilisateurs d’ouvrir, réparer et remplacer des pièces de leurs propres appareils entrent en conflit avec cette notion d’appartenance et créent un précédent dangereux. Le parallèle avec l’industrie automobile est souvent évoqué : ce serait impensable que Peugeot empêche l’utilisation des pièces détachées, s’oppose aux services offerts par des garagistes indépendants, ou rende impossible la personnalisation des voitures vendues.&lt;/p&gt;

&lt;h2 id=&quot;la-croisade-dapple&quot;&gt;La croisade d’Apple&lt;/h2&gt;

&lt;p&gt;Le choix de se focaliser sur Apple pour cet article est dû à l’immense portée de ses actions. En 2019, Apple devient la première boîte à atteindre le cap de 1.000.000.000.000 USD (un “trillion” pour les Américains, un billion les Français) de capitalisation boursière. C’est un montant stratosphérique : deux fois le PIB de la Suède et cinq fois le budget santé de la France. C’est plus que LLVH, L’Oréal, Sanofi, Airbus et Vinci &lt;em&gt;ensemble&lt;/em&gt;. Apple dispose donc des moyens pour établir une forte influence partout dans le monde.&lt;/p&gt;

&lt;p&gt;De plus, la firme de Cupertino perçoit la réparation de leurs produits comme un obstacle au profit. Tim Cook a même écrit dans une &lt;a href=&quot;https://www.vice.com/en_us/article/zmd9a5/tim-cook-to-investors-people-bought-fewer-new-iphones-because-they-repaired-their-old-ones&quot;&gt;lettre aux investisseurs&lt;/a&gt; en 2019 que la diminution des ventes de l’iPhone est en partie dû aux clients qui remplacent la batterie. Apple a plusieurs cordes à son arc quand il s’agit de bloquer les tentatives de réparation : du design de leurs produits jusqu’aux menaces légales en passant par des verrous software, lobbying politique et surfacturation des réparations officielles, entre autres.&lt;/p&gt;

&lt;h3 id=&quot;des-produits-difficiles-à-réparer&quot;&gt;Des produits difficiles à réparer&lt;/h3&gt;

&lt;p&gt;Un des mécanismes pour empêcher les utilisateurs de réparer c’est de concevoir les produits de façon à rendre cette tâche de plus en plus compliqué.&lt;/p&gt;

&lt;p&gt;Ça n’a pas toujours été comme ça. Au début des années 2000, l’iBook (ancêtre du Macbook) avait un clavier détachable à la main qui permettait d’accéder à l’emplacement de la mémoire RAM. Ce composant est important pour la vitesse de l’ordinateur et permet de faire tourner plusieurs applications en même temps. À cette époque, augmenter la mémoire pour donner un coup de neuf à un iBook prenait environ une minute et ne nécessitait pas d’outils particuliers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/ibook.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;From &lt;a href=&quot;https://www.macrepaircentral.us/ibook-g4-14-inch-early-2004/procedure-nik.html&quot;&gt;Mac Repair Central&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;h6 id=&quot;des-composants-soudés&quot;&gt;Des composants soudés&lt;/h6&gt;

&lt;p&gt;En 2008 Apple annonce le Macbook Air, le premier ordinateur portable de la gamme avec la mémoire soudée - et donc impossible à augmenter. Cette tendance a continué avec les lancements de produits subséquents.&lt;/p&gt;

&lt;p&gt;Aujourd’hui, la totalité des ordinateurs portables d’Apple ont la mémoire RAM, le processeur et le disque dur soudés, rendant ainsi impossible leur mise à jour. La faille d’un composant induit souvent à l’achat d’un nouvel ordinateur, menant d’autres composants en parfait état à la poubelle. iFixit - la plateforme phare en termes de réparation et économie circulaire - leur donne un &lt;a href=&quot;https://www.ifixit.com/Teardown/MacBook+Pro+16-Inch+2019+Teardown/128106#teardownConclusion&quot;&gt;score de 1/10&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/ifixit-macbook.jpg&quot; /&gt;&lt;/p&gt;

&lt;h6 id=&quot;bouton-daccueil&quot;&gt;Bouton d’accueil&lt;/h6&gt;

&lt;p&gt;Avec l’arrivée des iPhone 7 et 7 Plus, on a vu apparaître les boutons d’accueil “virtuels” : une surface fixe qui donne la sensation de clic quand on appuie dessus. Apple a profité de l’occasion pour mettre en place un système de blocage en cas de tentative de remplacement. Même en installant une nouvelle pièce originale le téléphone refusera de l’adopter. Il faut noter d’ailleurs qu’il ne s’agit pas d’une contrainte physique, ce comportement a été programmée volontairement dans iOS. D’un point de vue sécurité c’est compréhensible qu’on désactive le TouchID, mais rien n’obligeait Apple à empêcher la réparation du bouton lui-même. En cas de problème les consommateurs sont &lt;a href=&quot;https://www.igen.fr/iphone/2017/04/seule-apple-peut-remplacer-le-bouton-daccueil-des-iphone-7-99404&quot;&gt;obligés de passer par Apple&lt;/a&gt;.&lt;/p&gt;

&lt;h6 id=&quot;la-vis-pentalobe&quot;&gt;La vis pentalobe&lt;/h6&gt;

&lt;p&gt;Apple a aussi décidé de rendre leurs vises incompatibles avec les tournevis standard pour empêcher les utilisateurs d’ouvrir leurs propres appareils. Apple, comme la plupart des acteurs du marché, utilisait des vises standard Phillips. Néanmoins, en 2009 la gamme commence progressivement à adopter la vis &lt;em&gt;pentalobe&lt;/em&gt; qui ne s’accorde pas avec les tournevis existants. En 2010, les magasins Apple ont commencé à remplacer les vises standards des produits en réparation avec les nouvelles vises, ceci &lt;a href=&quot;https://www.reuters.com/article/us-apple-screws/apple-tightens-the-screws-on-iphone-4-sources-idUSTRE70K0BO20110121#wtsHylj4edrFHWBD.97&quot;&gt;sans informer les clients&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;De nos jours, tous les produits Apple utilisent cette vis non standard. Heureusement, en 2011 iFixit a mis au marché le “&lt;a href=&quot;https://eustore.ifixit.com/en/Parts/iPhone-Parts/iPhone-4S/iPhone-4-4S-Liberation-Kit.html&quot;&gt;iPhone liberation kit&lt;/a&gt;” qui inclut un tournevis &lt;em&gt;pentalobe&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/pentalobe.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;© Raimond Spekking / CC BY-SA 4.0 (via Wikimedia Commons)&lt;/small&gt;&lt;/p&gt;

&lt;h3 id=&quot;obsolescence-programmée&quot;&gt;Obsolescence programmée&lt;/h3&gt;

&lt;p&gt;Apple se trouve souvent au milieu des scandales liés à l’obsolescence programmée. À plusieurs reprises, des investigations ont été lancées pour déterminer si la firme de la pomme vise à réduire délibérément la durée de vie des produits pour en augmenter le taux de remplacement. Il faut noter qu’en France l’obsolescence programmée &lt;a href=&quot;https://www.legifrance.gouv.fr/affichCodeArticle.do?cidTexte=LEGITEXT000006069565&amp;amp;idArticle=LEGIARTI000032222841&amp;amp;dateTexte=&amp;amp;categorieLien=cid&quot;&gt;est un délit&lt;/a&gt; depuis 2015.&lt;/p&gt;

&lt;h6 id=&quot;les-iphones-bridés&quot;&gt;Les iPhones bridés&lt;/h6&gt;

&lt;p&gt;Un des cas les plus relayé par les médias est celui des mises à jour iOS qui ralentissent délibérément les iPhones. Apple a fini par admettre les accusations en les justifiant par un souci d’économie de batterie des anciens modèles. Néanmoins, le manque de transparence soulève des soupçons d’obsolescence programmée : les effets des mises à jour n’ont pas été communiqués et les utilisateurs se trouvaient avec des téléphones très lents sans en connaître la cause.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/iphone-waste.jpeg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;© Shutterstock&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Déjà en 2013, Catherine Rampbell, journaliste du New York Times, &lt;a href=&quot;https://www.nytimes.com/2013/11/03/magazine/why-apple-wants-to-bust-your-iphone.html?ref=magazine&amp;amp;_r=0&quot;&gt;écrit un article&lt;/a&gt; concernant le bridage volontaire de l’iPhone 4 lors de la mise à jour iOS 7. Ses options : payer $79 pour un remplacement de batterie ou mettre $20 de plus pour un nouvel iPhone 5C. Au moment ou l’article est sorti, plusieurs personnes voyaient une &lt;a href=&quot;https://gizmodo.com/no-apples-not-trying-to-bust-your-phone-1453999009&quot;&gt;théorie du complot&lt;/a&gt; plutôt qu’une initiative volontaire de la part d’Apple.&lt;/p&gt;

&lt;p&gt;En 2016, des &lt;a href=&quot;https://consomac.fr/news-7787-ios-le-bridage-volontaire-de-l-iphone-6s-se-confirme.html&quot;&gt;articles prouvant ce bridage intentionnel&lt;/a&gt; ont vu le jour grâce au travail de John Poole, fondateur de Geekbench. En même temps, le mécontentement de la part des clients commençait à &lt;a href=&quot;https://actions.sumofus.org/a/apple-arretez-d-imposer-des-mises-a-niveau-qui-bousillent-les-plus-anciens-modeles-d-iphone-et-d-ipad?sp_ref=227560679.99.173827.f.549302.2&amp;amp;source=fb&quot;&gt;se faire entendre&lt;/a&gt;. Apple décide alors de sortir du silence pour essayer de limiter les dégâts.&lt;/p&gt;

&lt;p&gt;2017 démarre avec une &lt;a href=&quot;https://consomac.fr/news-7798-apple-reconnait-brider-ses-anciens-modeles-d-iphone.html&quot;&gt;déclaration officielle d’Apple&lt;/a&gt; où ils reconnaissent avoir bridé la puissance de ses anciens téléphones. La justification : il faut limiter les pics de puissance des anciennes batteries pour éviter que les iPhones s’éteignent soudainement. Si c’est donc pour la bonne cause, pourquoi l’absence de communication ? En omettant cette information les utilisateurs frustrés sont souvent poussés à l’achat d’un nouveau produit ou au remplacement hors-garantie de la batterie.&lt;/p&gt;

&lt;p&gt;Plusieurs gouvernements ont entamé des investigations à ce sujet. En Italie, 10 millions d’amende en &lt;a href=&quot;https://slice42.com/iphone/2018/10/batterygate-10-millions-damende-pour-apple-en-italie-75502/&quot;&gt;ont été infligés&lt;/a&gt; en 2018 contre Apple. En 2020, année d’écriture de ce post, la firme de la pomme a été condamnée à &lt;a href=&quot;https://www.nouvelobs.com/societe/20200207.OBS24521/iphones-brides-apple-condamne-a-25-millions-d-euros-d-amende.html&quot;&gt;25 millions d’euros d’amende&lt;/a&gt; en France. Cependant, ces montants restent minuscules par rapport au profit qu’Apple a pu en tirer de ces pratiques.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/dgccrf.jpeg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;En France, la &lt;a href=&quot;https://www.economie.gouv.fr/dgccrf&quot;&gt;DGCCRF&lt;/a&gt; a annoncé l’amende de 25 millions d’euros le 7 février 2020&lt;/small&gt;&lt;/p&gt;

&lt;h6 id=&quot;la-prise-casque&quot;&gt;La prise casque&lt;/h6&gt;

&lt;p&gt;L’omission de la prise casque 3.5mm dans les smartphones Apple n’a pas laissé l’opinion publique indifférente. L’abandon d’une prise standard, ouverte et utilisée par des millions d’appareils depuis autour de cent ans en faveur d’une alternative propriétaire et fermée (le port Lightning) a suscité une &lt;a href=&quot;https://www.theverge.com/circuitbreaker/2016/6/21/11991302/iphone-no-headphone-jack-user-hostile-stupid&quot;&gt;vague de critiques&lt;/a&gt;. La justification employée par Phil Schiller, chef marketing Apple, est aussi étonnante qu’arrogante : &lt;em&gt;“Il nous a fallu du &lt;strong&gt;&lt;a href=&quot;https://www.engadget.com/2016/09/07/courage-is-not-how-you-sell-iphones/&quot;&gt;courage&lt;/a&gt;&lt;/strong&gt; pour proposer ce que nous considérons comme meilleur pour l’utilisateur”.&lt;/em&gt;&lt;/p&gt;

&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Even Mandela learned new things about courage today… &lt;a href=&quot;https://twitter.com/hashtag/AppleEvent?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#AppleEvent&lt;/a&gt; &lt;a href=&quot;https://twitter.com/hashtag/iPhone7?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#iPhone7&lt;/a&gt; &lt;a href=&quot;https://twitter.com/hashtag/AirPods?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#AirPods&lt;/a&gt; &lt;a href=&quot;https://twitter.com/hashtag/courage?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#courage&lt;/a&gt; &lt;a href=&quot;https://t.co/rOImiooOkB&quot;&gt;pic.twitter.com/rOImiooOkB&lt;/a&gt;&lt;/p&gt;&amp;mdash; ♏️ℹ️ⓔⓂ️⭕️ (@miemo) &lt;a href=&quot;https://twitter.com/miemo/status/773639495178674178?ref_src=twsrc%5Etfw&quot;&gt;September 7, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;p&gt;Parmi les plusieurs désavantages de cette tournure, l’&lt;a href=&quot;https://www.sylvaingingrasdemers.com/ecologie-ecouteurs-bluetooth-aberration/&quot;&gt;impact écologique&lt;/a&gt; saute aux yeux. L’incitation à acquérir des casques sans fil qui fonctionnent sur batterie entraîne forcément un bilan écologique plus lourd. Les mines de lithium nécessaires pour leur fabrication impactent fortement l’environnement en &lt;a href=&quot;https://www.enviro2b.com/2019/01/09/le-cout-environnemental-de-notre-dependance-aux-batteries-au-lithium/&quot;&gt;polluant les fleuves&lt;/a&gt; et en &lt;a href=&quot;https://reporterre.net/Corruption-pollution-consommation-les-ravages-du-lithium-en-Argentine&quot;&gt;menaçant des écosystèmes&lt;/a&gt; qui avaient jusqu’à là échappé l’impact humain. De plus, la batterie raccourci considérablement la durée de vie des casques sans-fil par rapport aux casques câblés, contribuant davantage au problème des déchets électroniques. Toujours est-il que pour Apple, rien de mieux pour augmenter ses recettes (rappelons-nous que la firme a acquis la &lt;a href=&quot;https://www.lemonde.fr/technologies/article/2014/05/28/apple-confirme-le-rachat-de-beats-electronics-pour-3-milliards-de-dollars_4428338_651865.html&quot;&gt;marque de casques audio Beats en 2013&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/lithium-protest.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;Manifestations contre les mines de lithium à Kangding. &lt;a href=&quot;https://ejatlas.org/conflict/a-sudden-mass-death-of-fish-in-the-lichu-river-in-minyak-lhagang-dartsedo-county-in-karze-prefecture&quot;&gt;EJ Atlas&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;L’innovation ne justifie pas, en 2016, de ne pas réfléchir aux impacts de ses décisions.
&lt;cite&gt;— &lt;a href=&quot;https://www.01net.com/actualites/pourquoi-apple-a-tort-de-supprimer-la-prise-jack-de-son-iphone-7-1036881.html&quot;&gt;Adrian Branco&lt;/a&gt;&lt;/cite&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;resistance-à-la-législation&quot;&gt;Resistance à la législation&lt;/h3&gt;

&lt;p&gt;L’influence d’Apple s’exerce aussi dans l’&lt;a href=&quot;https://www.challenges.fr/high-tech/batailles-d-influence-avec-les-grandes-puissances_689450&quot;&gt;écosystème gouvernemental&lt;/a&gt;, où des équipes de lobbyistes accréditées, fédérations, avocats et consultants se battent pour que les lois s’accordent aux intérêts de la firme. Ceci ne va pas toujours de la main avec les priorités sociétales : une meilleure protection des données, un système de taxation plus juste et la protection à l’environnement.&lt;/p&gt;

&lt;p&gt;Aux États-Unis, un projet de loi nommé &lt;em&gt;Fair Repair Act&lt;/em&gt; a vu le jour dans l’état de New York en 2015. Il exige aux fabricants de mettre à disposition du public des informations de réparation de leurs appareils ainsi que de vendre des pièces détachées pour faciliter la réparation. Apple n’a pas tardé à engager le cabinet de lobbying Roffe Group pour convaincre les législateurs de faire marche arrière. Ces efforts ont porté ses fruits : le Sénat de New York n’a pas réussi à faire passer le Fair Repair Act. Massachusetts et la Californie ont aussi échoué face au lobbying anti-réparation qui défendait sa position en affirmant que &lt;a href=&quot;https://www.zdnet.fr/actualites/la-raison-stupide-d-apple-pour-essayer-d-empecher-la-reparation-de-son-iphone-39884271.htm&quot;&gt;les consommateurs pourraient se blesser&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/repair-protest.jpeg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;© Kyle Wiens, iFixit.com&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Au Canada, le parlement d’Ontario a également présenté un projet de loi pro-réparation en février 2019. Celui-ci aurait permis la vente des pièces originales détachées aux consommateurs (par exemple, des écrans iPhone) pour encourager la remise en état des appareils électroniques. Apple, via l’&lt;em&gt;Electronics Product Stewardship Canada&lt;/em&gt; a aussi réussi à &lt;a href=&quot;https://appleinsider.com/articles/19/05/03/apple-tech-companies-successfully-lobby-to-kill-ontario-right-to-repair-bill&quot;&gt;mettre fin à cette initiative&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Au jour d’écriture de ce post, Apple ne fournit aucune pièce ou manuels de réparation en dehors de son réseau officiel.&lt;/p&gt;

&lt;h6 id=&quot;lunion-européenne-et-la-garantie-obligatoire&quot;&gt;L’Union Européenne et la garantie obligatoire&lt;/h6&gt;

&lt;p&gt;La lutte n’est pas finie même quand des lois de protection au consommateur sont promulguées. En 1999, l’Union Européenne a adopté la directive &lt;a href=&quot;http://admi.net/eur/loi/leg_euro/fr_399L0044.html&quot;&gt;1999/44/CE&lt;/a&gt; obligeant les vendeurs à offrir une garantie de réparation ou remplacement de deux ans minimum. Apple a décidé de &lt;a href=&quot;https://www.numerama.com/magazine/22072-apple-et-sa-garantie-d-un-an-violation-du-droit-europeen.html&quot;&gt;faire croire aux consommateurs&lt;/a&gt; que la garantie de base dure un an pour rendre l’“AppleCare Protection Plan” plus attractif. Suite à une mise en cause en Europe, &lt;a href=&quot;https://www.01net.com/actualites/apple-applique-la-garantie-legale-de-deux-ans-sur-ses-produits-597537.html&quot;&gt;Apple a du bien clarifier&lt;/a&gt; que la garantie minimale est de deux ans. Le gouvernement italien a imposé &lt;a href=&quot;https://www.linformaticien.com/actualites/id/22851/l-italie-condamne-apple-a-une-amende-de-900000-euros.aspx&quot;&gt;900000 euros d’amende&lt;/a&gt; à Apple pour ce mauvais tour.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/garantie-un-an.png&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;Site d’Apple malgré la directive Européenne étendant la garantie à deux ans.&lt;/small&gt;&lt;/p&gt;

&lt;h3 id=&quot;attaques-aux-indépendants&quot;&gt;Attaques aux indépendants&lt;/h3&gt;

&lt;p&gt;Malgré les efforts d’Apple, des réparateurs indépendants font le maximum pour faire durer ces produits. Ceci n’est pas sans conséquences : les querelles entre l’entreprise de Cupertino et les micro-entreprises prêtes à effectuer des réparations sont fréquentes. Le rapport de force n’est pas du tout le même, forçant plusieurs techniciens à mettre la clé sous la porte.&lt;/p&gt;

&lt;p&gt;La vidéo ci-dessous présente une &lt;a href=&quot;https://ici.radio-canada.ca/nouvelle/1131105/technologie-apple-reparation-prix-restriction-accusation&quot;&gt;enquête faite par la chaîne américaine CBC news&lt;/a&gt;. À l’aide d’une caméra cachée, un consommateur se rend à l’Apple store pour faire réparer l’écran de son Macbook. Le coût : 1200 dollars. L’employée ne s’attarde pas à rappeler le prix d’un nouvel ordinateur, qui n’est pas loin de celui de la réparation. Le consommateur se rend ensuite au petit magasin de réparation de Louis Rossmann (non agrée par Apple). Rossmann identifie le problème : une broche courbée qui n’établissait plus de contact, facilement réglable à l’aide d’une pince. La manipulation étant trop petite pour charger quoi que ce soit, le Macbook est réparé pour zéro dollars.&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/o2_SZ4tfLns?rel=0&amp;amp;showinfo=0&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;La suite n’a pas été facile pour Rossmann, qui anime aussi une chaîne YouTube sur la réparation. Quelques jours après sa participation dans l’enquête CBC, la douane américaine - en liaison avec Apple - lui a &lt;a href=&quot;https://www.iphoneincanada.ca/news/nyc-repair-tech-apple-customs-seize-batteries/&quot;&gt;confisqué un colis contenant des batteries originales MacBook&lt;/a&gt;. Rossmann n’est pas un inconnu des services légaux Apple, &lt;a href=&quot;https://www.ifixit.com/News/8210/rossmann-repair-legal-threat&quot;&gt;qui l’avaient déjà menacé auparavant&lt;/a&gt; suite aux vidéos où il explique comment réparer des produits électroniques. D’autres micro-entrepreneurs, tels que &lt;a href=&quot;https://www.vice.com/en_us/article/evk4wk/dhs-seizes-iphone-screens-jessa-jones&quot;&gt;Jessa Jones&lt;/a&gt; et &lt;a href=&quot;https://www.fudzilla.com/news/48835-apple-continues-repair-witchhunt&quot;&gt;Henrik Huseby&lt;/a&gt;, ont aussi eu affaire à Cupertino, principalement au sujet des pièces utilisées pour les réparations.&lt;/p&gt;

&lt;h3 id=&quot;des-réparateurs-indépendants-certifiés-par-apple-&quot;&gt;Des réparateurs indépendants certifiés par Apple ?&lt;/h3&gt;

&lt;p&gt;Sous la pression du mouvement pour le droit à la réparation, Apple a annoncé en 2019 un &lt;a href=&quot;https://support.apple.com/irp-program&quot;&gt;programme de certification&lt;/a&gt; pour les réparateurs indépendants. Ceux qui participent auraient aussi l’opportunité d’acheter des pièces détachées officielles. Ce programme a néanmoins connu une opposition considérable à cause du &lt;a href=&quot;https://www.vice.com/en_us/article/qjdjnv/apples-independent-repair-program-is-invasive-to-shops-and-their-customers-contract-shows&quot;&gt;contrat à signer&lt;/a&gt; par les entreprises voulant se certifier : Apple les oblige à partager toutes les informations de leurs clients avec eux, impose des audits surprises même cinq ans après une éventuelle sortie du programme, établi des amendes excessives en cas de désobéissance, et demande aux clients de signer un document déclarant que la réparation ne sera pas reconnue par Apple. Il va sans dire que ce n’est pas la joie dans la communauté des réparateurs.&lt;/p&gt;

&lt;h2 id=&quot;le-changement-est-possible-mais-comment-&quot;&gt;Le changement est possible, mais comment ?&lt;/h2&gt;

&lt;h6 id=&quot;diffusion&quot;&gt;Diffusion&lt;/h6&gt;

&lt;p&gt;La stratégie marketing d’Apple est très sensible à l’opinion publique. Apple tente de se positionner comme une marque branchée, créative, jeune et dans l’air du temps. Relayer des articles concernant leurs pratiques anti-réparation et leurs répercussions environnementales peut aider. Ce ne serait pas la première fois : la campagne “&lt;a href=&quot;https://wayback.archive-it.org/9650/20191124022806/http://p3-raw.greenpeace.org/international/en/news/features/greening-of-apple-310507/&quot;&gt;Green my Apple&lt;/a&gt;” de Greenpeace a provoqué un virage vers des pratiques plus vertes à Cupertino, et la lettre ouverte de JANA concernant &lt;a href=&quot;https://www.wsj.com/articles/iphones-and-children-are-a-toxic-pair-say-two-big-apple-investors-1515358834&quot;&gt;l’addiction aux smartphones&lt;/a&gt; a abouti dans l’implémentation de la fonctionnalité “Screen Time” sur iOS.&lt;/p&gt;

&lt;h6 id=&quot;achat-du-matériel-reconditionné&quot;&gt;Achat du matériel reconditionné&lt;/h6&gt;

&lt;p&gt;Les alternatives existent aussi pour ceux qui ont besoin des produits Apple. Des sites comme &lt;a href=&quot;https://www.backmarket.fr/&quot;&gt;BackMarket&lt;/a&gt;, &lt;a href=&quot;https://smaaart.fr/&quot;&gt;Smaart&lt;/a&gt;, &lt;a href=&quot;https://www.rebuy.fr/&quot;&gt;Rebuy&lt;/a&gt; et &lt;a href=&quot;https://www.recommerce.com/fr/&quot;&gt;Recommerce&lt;/a&gt; permettent d’acheter des iPhones, iPads et Macs reconditionnés tout en garantissant leur qualité.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/reconditionne.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;Reconditionnement des iPhones. Photo de Charly Triballeau-AFP&lt;/small&gt;&lt;/p&gt;

&lt;h6 id=&quot;réparation-de-lexistant&quot;&gt;Réparation de l’existant&lt;/h6&gt;

&lt;p&gt;Suite à la réticence des services officiels de réparation Apple et aux contraintes auxquelles les boutiques agrées sont soumises, il est toujours utile de regarder du côté des réparateurs indépendants non-agrées. Des magasins comme &lt;a href=&quot;https://specialmac.fr/&quot;&gt;MacBoutic&lt;/a&gt; à Lyon, &lt;a href=&quot;https://www.macinfo.fr/&quot;&gt;MacInfo&lt;/a&gt; à Paris ou &lt;a href=&quot;https://www.atelierexpress.com/&quot;&gt;Atelier Express&lt;/a&gt; à Marseille offrent des services à un prix raisonnable qui permettent d’allonger la durée de vie de votre appareil.&lt;/p&gt;

&lt;h6 id=&quot;soutien-aux-associations&quot;&gt;Soutien aux associations&lt;/h6&gt;

&lt;p&gt;L’association HOP (Halte à l’obsolescence programmée) mène plusieurs actions en faveur des consommateurs et contre des pratiques anti-réparation. En 2017 ils ont &lt;a href=&quot;https://www.halteobsolescence.org/hop-porte-plainte-contre-apple-obsolescence-programmee/&quot;&gt;porté plainte contre Apple&lt;/a&gt; suite aux révélations des techniques visant à ralentir les iPhones. L’association a plaidé pour la réversibilité des mises à jour ainsi que l’amovibilité des batteries lors d’une audition par le Sénat en 2017. Pour faire un don &lt;a href=&quot;https://www.halteobsolescence.org/faire-un-don/&quot;&gt;c’est par ici&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/hop.jpg&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;&lt;a href=&quot;https://www.halteobsolescence.org/&quot;&gt;HOP - Halte à l’obsolescence programmée&lt;/a&gt;.&lt;/small&gt;&lt;/p&gt;

&lt;h6 id=&quot;quitter-apple&quot;&gt;Quitter Apple&lt;/h6&gt;

&lt;p&gt;Il existe aussi des alternatives aux iPhones qui affichent une bien meilleure réparabilité. &lt;a href=&quot;https://www.fairphone.com/fr/&quot;&gt;Fairphone&lt;/a&gt; est une entreprise sociale basée aux Pays-Bas qui fabrique des smartphones éthiques et modulaires basés sur Android. Le Faiphone est le seul téléphone à avoir obtenu l’indice maximal de réparabilité : 10/10 sur la plateforme iFixIt. Les matériaux utilisés sont recyclés et équitables (l’or est même certifié FairTrade).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/fairphone.jpg&quot; style=&quot;max-height: 350px; width: auto;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Côté ordinateurs, abandonner OS X pour un système d’exploitation performant, respectueux de la vie privée et réparable est aussi possible. Linux a longtemps désintéressé les moins technophiles à cause de sa technicité perçue comme trop élevée. Néanmoins, dans les dernieres années plusieurs distributions (par ex, &lt;a href=&quot;https://elementary.io/&quot;&gt;Elementary OS&lt;/a&gt;, &lt;a href=&quot;https://ubuntu.com/desktop/features&quot;&gt;Ubuntu&lt;/a&gt; ou &lt;a href=&quot;https://getfedora.org/&quot;&gt;Fedora&lt;/a&gt;) ont fait des avancées en matière d’ergonomie et design et se positionnent aujourd’hui comme des alternatives aux systèmes commerciales. De plus, OS X et Windows ont subi plusieurs critiques suite au traitement des données personnelles et au faible support d’ancien matériel, ce qui pousse de plus en plus de consommateurs vers des distributions Linux.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/elementary.jpg&quot; style=&quot;max-height: 350px; width: auto;&quot; /&gt;
&lt;small class=&quot;caption&quot;&gt;&lt;a href=&quot;https://elementary.io/&quot;&gt;Elementary OS&lt;/a&gt;, une distribution Linux.&lt;/small&gt;&lt;/p&gt;

&lt;h2 id=&quot;think-different&quot;&gt;&lt;em&gt;Think Different&lt;/em&gt;&lt;/h2&gt;

&lt;p&gt;En 1997 Apple a présenté sa campagne publicitaire “Think Different”, &lt;em&gt;Pensez Différent&lt;/em&gt; en français - faute grammaticale assumée. Le slogan a été utilisé dans un &lt;a href=&quot;https://www.youtube.com/watch?v=sz9_mwgkvAQ&quot;&gt;spot publicitaire&lt;/a&gt; ou Steve Jobs récite “Here’s to the crazy ones” de Bob Siltanen avec des images des personnalités célèbres tels qu’Albert Einstein, John Lennon et Martin Luther King. Apple se voulait être un des rebelles et désadaptés qui changent le monde.&lt;/p&gt;

&lt;p&gt;En 2020, face à la crise climatique et l’irresponsabilité d’Apple, il est temps - plus que jamais - de penser &lt;em&gt;différemment&lt;/em&gt;.&lt;/p&gt;</content><author><name></name></author><category term="Société" /><category term="Environnement" /><summary type="html">La réparation - perçue comme un obstacle au profit par Apple - présente des nombreuses avantages au niveau individuel, sociétal et écologique. Le changement est possible, mais comment ?</summary></entry><entry><title type="html">Mesurer la performance avec Locust</title><link href="http://alemangui.github.io/locust" rel="alternate" type="text/html" title="Mesurer la performance avec Locust" /><published>2020-02-11T00:00:00+01:00</published><updated>2020-02-11T00:00:00+01:00</updated><id>http://alemangui.github.io/locust</id><content type="html" xml:base="http://alemangui.github.io/locust">&lt;p&gt;Toute application doit pouvoir répondre à un certain nombre de requêtes sous un temps minimum jugé comme acceptable. Ceci peut varier énormément. Google fait face à des millions d’utilisateurs et se fixe des objectifs de performance très ambitieux. D’un autre côté, un système de gestion d’inventaires d’une petite épicerie difficilement aura plus d’une poignée d’utilisateurs et n’aura pas les mêmes contraintes de temps de réponse.&lt;/p&gt;

&lt;p&gt;Les tests de charge servent à assurer que notre application réponde à nos objectifs liés au nombre d’utilisateurs simultanées et temps de réponse. C’est là que &lt;a href=&quot;https://locust.io/&quot;&gt;Locust&lt;/a&gt; rentre en action : un outil pour simuler des utilisateurs virtuels et permettre leur analyse. Par rapport aux alternatives Locust a un grand plus : on écrit nos tests en Python pur et dur.&lt;/p&gt;

&lt;h2 id=&quot;préparons-le-terrain&quot;&gt;Préparons le terrain&lt;/h2&gt;

&lt;p&gt;Avant de jouer avec Locust, il faut bien qu’on ait quelque chose à tester. Pour le fun, nous allons faire un hello-world avec Flask.&lt;/p&gt;

&lt;p&gt;Je vais d’abord démarrer un environnement virtuel avec Python 3 dans un dossier vide, suivi de l’installation de Flask avec &lt;code class=&quot;highlighter-rouge&quot;&gt;pip&lt;/code&gt; :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;» virtualenv &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; python3 venv
» &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; venv/bin/activate
» pip install flask&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Créons maintenant un fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;hello.py&lt;/code&gt; avec le code disponible dans le &lt;a href=&quot;https://flask.palletsprojects.com/en/1.1.x/quickstart/#a-minimal-application&quot;&gt;site Flask&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hello_world&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Hello, World!'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Et voilà, nous avons un endpoint sur &lt;code class=&quot;highlighter-rouge&quot;&gt;http://127.0.0.1:5000/&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;» &lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;FLASK_APP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;hello.py&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; flask run
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Serving Flask app &lt;span class=&quot;s2&quot;&gt;&quot;hello.py&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Debug mode: off
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Running on http://127.0.0.1:5000/ &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Press CTRL+C to quit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;locust-entre-en-jeu&quot;&gt;Locust entre en jeu&lt;/h2&gt;

&lt;p&gt;Locust permet de simuler de milliers d’utilisateurs simultanés sur notre app. Derrière le rideau, il crée un processus léger via gevent (plus précisément un &lt;a href=&quot;http://www.gevent.org/api/gevent.greenlet.html&quot;&gt;greenlet&lt;/a&gt;) par utilisateur simulé. Ce choix technique permet de simuler un grand nombre d’usagers sur une seule machine.&lt;/p&gt;

&lt;p&gt;Commençons par créer un fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;locustfile.py&lt;/code&gt;. Ce fichier servira pour décrire les tests de charge.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;locust&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpLocust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TaskSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;between&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UserBehaviour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TaskSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@task&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WebsiteUser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpLocust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UserBehaviour&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;wait_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;between&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;La class &lt;code class=&quot;highlighter-rouge&quot;&gt;UserBehaviour&lt;/code&gt; nous permet de définir l’activité que les usagers vont mener. Dans notre cas il y a un seul et unique endpoint à la racine qu’on represente ici avec la fonction &lt;code class=&quot;highlighter-rouge&quot;&gt;index&lt;/code&gt; décoré avec &lt;code class=&quot;highlighter-rouge&quot;&gt;@task&lt;/code&gt; pour indiquer à Locust qu’il s’agit d’une tâche que les utilisateurs vont effectuer.&lt;/p&gt;

&lt;p&gt;La class &lt;code class=&quot;highlighter-rouge&quot;&gt;WebsiteUser&lt;/code&gt; represente l’utilisateur lui même. On spécifie la &lt;code class=&quot;highlighter-rouge&quot;&gt;task_set&lt;/code&gt; qu’il réalisera ainsi que le temps qu’il attend entre chaque tâche - entre cinq et neuf secondes dans notre cas.&lt;/p&gt;

&lt;p&gt;Si vous avez nommé ce fichier &lt;code class=&quot;highlighter-rouge&quot;&gt;locustfile.py&lt;/code&gt; il suffit de taper &lt;code class=&quot;highlighter-rouge&quot;&gt;locust&lt;/code&gt; dans la console pour tout démarrer. Si vous l’avez nommé différemment il faudra ajouter &lt;code class=&quot;highlighter-rouge&quot;&gt;-f &amp;lt;&amp;lt;path-to-file&amp;gt;&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;» locust
   &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&amp;lt;date&amp;gt;] /INFO/locust.main: Starting web monitor at http://&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;:8089
   &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&amp;lt;date&amp;gt;] /INFO/locust.main: Starting Locust 0.14.4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Locust a mis en place l’interface web sur &lt;code class=&quot;highlighter-rouge&quot;&gt;http://localhost:8089&lt;/code&gt;. Cette interface nous permet de spécifier le nombre d’usagers à simuler, le taux de création de ces utilisateurs et l’URL de l’application à tester. Démarrons nos tests avec 100 utilisateurs avec un taux de croissance de dix par seconde. Vu que notre hello-world Flask tourne toujours sur le port &lt;code class=&quot;highlighter-rouge&quot;&gt;:5000&lt;/code&gt; on peut le remplir comme cela :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/locust-1.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Après avoir appuyé sur le bouton &lt;em&gt;start swarming&lt;/em&gt; le test se met en œuvre. Dans l’entête de la page on trouve le nombre d’utilisateurs simultanées, les requêtes par seconde (RPS) et le pourcentage d’échec. Plus bas, dans la table on peut aussi connaître le temps de réponse de notre application.&lt;/p&gt;

&lt;p&gt;Notez aussi les onglets :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;Charts&lt;/em&gt; contient des visualisations concernant les temps de réponse, les requêtes par seconde et le nombre d’usagers,&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;Failures&lt;/em&gt; et &lt;em&gt;Exceptions&lt;/em&gt; donne davantage d’information sur les problèmes rencontrés lors du test, et&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;Download Data&lt;/em&gt; permet de télécharger les données bruts en CSV.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/locust-2.jpg&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;plus-dendpoints&quot;&gt;Plus d’endpoints&lt;/h2&gt;

&lt;p&gt;Dans la vie réelle on voudra tester des applications qui ont plus d’un endpoint. Par exemple, on peut avoir de comptes utilisateur (et donc un &lt;code class=&quot;highlighter-rouge&quot;&gt;/login&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;/logout&lt;/code&gt;). Puis on pourrait aussi mettre à disposition un endpoint pour paramétrer le compte (&lt;code class=&quot;highlighter-rouge&quot;&gt;/account&lt;/code&gt;) ainsi qu’un autre pour accéder au panier d’achat (&lt;code class=&quot;highlighter-rouge&quot;&gt;/cart&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Ajoutons ces nouvelles routes à notre app Flask sur &lt;code class=&quot;highlighter-rouge&quot;&gt;hello.py&lt;/code&gt; :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;flask&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Home'&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/login'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Login'&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/logout'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Logout'&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/account'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Account'&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@app.route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/cart'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Cart'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;authentification&quot;&gt;Authentification&lt;/h3&gt;

&lt;p&gt;Cette fois-ci nos utilisateurs doivent s’identifier avant d’accéder aux autres pages. De plus, ils fermeront leur session après avoir fini. Les fonctions &lt;code class=&quot;highlighter-rouge&quot;&gt;on_start&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;on_stop&lt;/code&gt; sont appelées avant l’exécution de la première tâche et après la fin du TaskSet respectivement. C’est donc idéal pour placer l’authentification :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UserBehaviour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TaskSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/login'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/logout'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;comportement-des-usagers&quot;&gt;Comportement des usagers&lt;/h3&gt;

&lt;p&gt;Vu le nombre des pages dans notre app, ce serait utile de paramétrer &lt;code class=&quot;highlighter-rouge&quot;&gt;UserBehaviour&lt;/code&gt; pour que les pages ne soient pas toutes visitées pareil. Nous pouvons nous attendre à que la page d’accueil (&lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt;) soit souvent visité. D’un autre côté, du fait que les utilisateurs ne paramètrent pas leur compte tous les jours, &lt;code class=&quot;highlighter-rouge&quot;&gt;/account&lt;/code&gt; ne sera pas un passage obligé pour tous. Finalement, le panier d’achat (&lt;code class=&quot;highlighter-rouge&quot;&gt;/cart&lt;/code&gt;) se situe un peu au milieu en terme d’affluence.&lt;/p&gt;

&lt;p&gt;Pour ce faire on s’appuiera sur le décorateur &lt;code class=&quot;highlighter-rouge&quot;&gt;@task&lt;/code&gt;, plus précisément sur son paramètre facultatif entier qui répresente le poids, çad la probabilité qu’un utilisateur choisisse la tâche en question pour son action suivante. Une tâche &lt;code class=&quot;highlighter-rouge&quot;&gt;@task(10)&lt;/code&gt; a dix fois plus de probabilité d’être choisie qu’une tâche &lt;code class=&quot;highlighter-rouge&quot;&gt;@task(1)&lt;/code&gt;. Nous pouvons donc récrire notre &lt;code class=&quot;highlighter-rouge&quot;&gt;locustfile.py&lt;/code&gt; de la façon suivante :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;locust&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpLocust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TaskSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;between&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;UserBehaviour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TaskSet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/login'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/logout'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/cart&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/account&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WebsiteUser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HttpLocust&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task_set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;UserBehaviour&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;wait_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;between&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Si on applique les mêmes paramètres que lors du dernier test, on obtient ces résultats :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/locust-3.jpg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;On constate que chacun des 100 utilisateurs s’est identifié et a fini par fermer sa session. Le poids qu’on a assigné aux tâches a bien été respecté : la page d’accueil a été visité autour de dix fois plus que celle de paramétrage du compte et deux fois plus que le panier d’achat.&lt;/p&gt;

&lt;h2 id=&quot;locust-en-mode-distribuée&quot;&gt;Locust en mode distribuée&lt;/h2&gt;

&lt;p&gt;Si nos besoins de simulation sont trop importants pour être faits sur une seule machine, Locust permet d’exécuter les tests de façon distribuée. Il suffit de créer une instance Locust &lt;em&gt;master&lt;/em&gt; (avec l’option &lt;code class=&quot;highlighter-rouge&quot;&gt;-master&lt;/code&gt;) à laquelle on ajoutera des noeuds créés avec l’option &lt;code class=&quot;highlighter-rouge&quot;&gt;slave&lt;/code&gt; et &lt;code class=&quot;highlighter-rouge&quot;&gt;---master-host&lt;/code&gt; pour indiquer où se trouve l’instance maître.&lt;/p&gt;

&lt;p&gt;Sur une machine on ferait :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;locust &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mon_locustfile.py &lt;span class=&quot;nt&quot;&gt;--master&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Et on ajouterait des noeuds avec :&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;locust &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; mon_locustfile.py &lt;span class=&quot;nt&quot;&gt;--slave&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--master-host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.0.14&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;en-conclusion&quot;&gt;En conclusion&lt;/h2&gt;

&lt;p&gt;Locust met à disposition des outils simples et puissants pour mesurer le comportement d’un système en fonction de la charge d’utilisateurs simultanés. La courbe d’apprentissage est particulièrement rapide, la documentation est claire et la flexibilité apportée par le choix de Python pour décrire les tests offre des vastes possibilités pour des cas spéciaux. L’interface graphique est plutôt basique, mais les données bruts sont disponibles pour ceux qui ont besoin de les traiter davantage.&lt;/p&gt;

&lt;p&gt;J’ai mis en place Locust pour mon projet actuel et je ne peux que le recommander.&lt;/p&gt;

&lt;h3 id=&quot;comparaison-avec-jmeter&quot;&gt;Comparaison avec JMeter&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://jmeter.apache.org/&quot;&gt;JMeter&lt;/a&gt; est basé sur Java et contient une interface graphique pour décrire nos tests, contrairement à Locust où on se sert du code Python. Je ne trouve pas leur UI très ergonomique : les cas d’usage de base sont plutôt difficiles à effectuer et souvent nécessitent des plugins externes pour fonctionner.&lt;/p&gt;

&lt;h3 id=&quot;comparaison-avec-tsung&quot;&gt;Comparaison avec Tsung&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://tsung.erlang-projects.org/&quot;&gt;Tsung&lt;/a&gt; est basé sur Erlang et la machine virtuelle BEAM, un très bon choix pour une application basé sur des processus légers concurrents. Par contre, Tsung a besoin d’un fichier xml cauchemardesque pour décrire les tests. De plus, le projet a l’air plutôt dormant depuis un an.&lt;/p&gt;</content><author><name></name></author><category term="Développement" /><category term="Python" /><summary type="html">Toute application doit pouvoir répondre à un certain nombre de requêtes sous un temps minimum acceptable. Locust nous aide à faire les tests de charge nécessaires pour en être sûrs.</summary></entry><entry><title type="html">Web Audio: the ugly click and the human ear</title><link href="http://alemangui.github.io/ramp-to-value" rel="alternate" type="text/html" title="Web Audio: the ugly click and the human ear" /><published>2015-12-26T00:00:00+01:00</published><updated>2015-12-26T00:00:00+01:00</updated><id>http://alemangui.github.io/ramp-to-value</id><content type="html" xml:base="http://alemangui.github.io/ramp-to-value">&lt;style&gt;
.button {
    border: none;
    color: white;
    font-weight: bold;
    padding: 10px;
    min-width: 50px;
    min-height: 50px;
    border-radius: 5px;
    position: relative;
    -webkit-appearance: button;
    cursor: pointer;
    text-transform: none;
}

.stop-button {
    background-color: rgb(178, 78, 78);
    border-radius: 5px 0px 0px 5px;
}

.stop-button:hover {
    background-color: rgb(200, 106, 106);
}

.stop-button:before {
    content: &quot;&quot;;
    position: absolute;
    left: 15px;
    width: 21px;
    height: 21px;
    margin-top: -10px;
    background: white;
}

.play-button {
    background-color: rgb(103, 178, 78);
    min-width: 100px;
    border-radius: 0px 5px 5px 0px;
}

.play-button:hover {
    background-color: rgb(126, 200, 101);
}

.play-button:before {
    content: &quot;&quot;;
    position: absolute;
    left: 38px;
    border: 8px solid transparent;
    border-width: 12px 30px;
    border-left-color: #FFFFFF;
    margin-top: -12px;
    background: transparent;
}
&lt;/style&gt;

&lt;p&gt;While playing around with a Web Audio demo, I noticed a clicking sound every time a I stopped an oscillator.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;AudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;oscillatorNode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createOscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;oscillatorNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// click!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;button class=&quot;button stop-button&quot; id=&quot;1-stop-button&quot;&gt;&lt;/button&gt;
&lt;button class=&quot;button play-button&quot; id=&quot;1-play-button&quot;&gt;&lt;/button&gt;
&lt;script&gt;
	var context = new AudioContext();
	var oscillator;
	var firstIsPlaying;
	(function() {
		document.getElementById('1-play-button').addEventListener('click', function() {
			if(firstIsPlaying) return;
			oscillator = context.createOscillator();
			oscillator.connect(context.destination);
			oscillator.start();
			firstIsPlaying = true;
		}, false);
		document.getElementById('1-stop-button').addEventListener('click', function() {
			if (!firstIsPlaying) return;
			oscillator.stop();
			firstIsPlaying = false;
		}, false);		
	})();
&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;Could it be an implementation problem on the browser? Not likely, since this happened in all browsers I tested.&lt;/p&gt;

&lt;p&gt;Turns out the click sound happens because I’m abruptingly cutting the sound wave at a point other than the natural zero crossing:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/zero-crossing-point.svg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Is there a way to avoid this clicking sound then?&lt;/p&gt;

&lt;p&gt;We have two options:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Stopping the sound only at zero-point crossings, or&lt;/li&gt;
  &lt;li&gt;Creating a node gain to gradually decrease the gain to zero before stopping&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I will focus on the second option since - luckily - Web Audio API has us covered.&lt;/p&gt;

&lt;h2 id=&quot;gradual-changes-to-an-audioparam-value&quot;&gt;Gradual changes to an audioParam value&lt;/h2&gt;

&lt;h3 id=&quot;exponential-vs-linear&quot;&gt;Exponential vs linear&lt;/h3&gt;

&lt;p&gt;There are several Web Audio functions that can gradually change an audioParam:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;linearRampToValueAtTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;endTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// linear&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;exponentialRampToValueAtTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;endTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// exponential&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;setTargetAtTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;startTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timeConstant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// exponential&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;One difference between them is the easing function that is used to change the audio param value; either linear (left) or exponential (right).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/images/exponential-linear-curves.svg&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Mozilla has a piece of advise to those unsure of which one to use:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Exponential ramps are considered more useful when changing frequencies or playback rates than linear ramps because of the way the human ear works.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;And they are right: the human ear perceives sound on a logarithmic principle. An A3 note is a frequency of 220Hz, whereas A4 is 440Hz and A5 is 880Hz. Loudness also works this way: a tenfold increase in sound power could be described as being twice as loud. Hence, using an exponential gain decrease will be perceived as linear by the human ear.&lt;/p&gt;

&lt;h3 id=&quot;exponentialramptovalueattime-vs-settargetattime&quot;&gt;exponentialRampToValueAtTime vs setTargetAtTime&lt;/h3&gt;

&lt;p&gt;We will choose and exponential way of gradually decreasing the gain. This leaves us with &lt;code class=&quot;highlighter-rouge&quot;&gt;exponentialRampToValueAtTime&lt;/code&gt; vs &lt;code class=&quot;highlighter-rouge&quot;&gt;setTargetAtTime&lt;/code&gt;. Some difference between them are:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;exponentialRampToValueAtTime&lt;/code&gt; will get to the value precisely at the time specified. However, using this function, an exponential ramp to zero &lt;a href=&quot;https://webaudio.github.io/web-audio-api/#widl-AudioParam-exponentialRampToValueAtTime-AudioParam-float-value-double-endTime&quot;&gt;is not possible&lt;/a&gt; because of the math used to calculate the values over time.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;setTargetAtTime&lt;/code&gt; exponentially moves towards the value given by the target parameter, but instead of specifying an end time, we give the function an exponential decay rate after which the value will decrease about 2/3rds. This means we can ask the function to go all the way down to zero. Theoretically it will never really reach zero since it will be exponentially decaying, but in real life it &lt;em&gt;will&lt;/em&gt; as soon as the value is too small to be represented with a float.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Let’s choose &lt;code class=&quot;highlighter-rouge&quot;&gt;setTargetAtTime&lt;/code&gt; because we want to go all the way down to zero and because we are not too worried about getting there at a super precise time. As long as the fade-out time is fast enough to be imperceptible but slow enough to remove the click, we will be happy.&lt;/p&gt;

&lt;h3 id=&quot;using-settargetattime-to-remove-the-click&quot;&gt;Using setTargetAtTime to remove the click&lt;/h3&gt;

&lt;p&gt;Before trying out &lt;code class=&quot;highlighter-rouge&quot;&gt;setTargetAtTime&lt;/code&gt; to get rid of the ugly click, we must be of a couple gotchas:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;We must choose a decay time after which the gain value will decrease about 2/3rds. After a bit of experimenting, I found out that a decay time of 15 milliseconds gives the impression of being immediate but at the same time removes the click. Remember: Web Audio uses seconds instead of milliseconds!&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;AudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createOscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createGain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;stopButton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'click'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setTargetAtTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.015&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;button class=&quot;button stop-button&quot; id=&quot;2-stop-button&quot;&gt;&lt;/button&gt;
&lt;button class=&quot;button play-button&quot; id=&quot;2-play-button&quot;&gt;&lt;/button&gt;
&lt;script&gt;
	var gainNode;
	var secondIsPlaying;
	(function() {
		document.getElementById('2-play-button').addEventListener('click', function() {
			if(secondIsPlaying) return;
			gainNode = context.createGain();
			oscillator = context.createOscillator();
			oscillator.connect(gainNode);
			gainNode.connect(context.destination);
			oscillator.start();
			secondIsPlaying = true;
		}, false);
		document.getElementById('2-stop-button').addEventListener('click', function() {
			if (!secondIsPlaying) return;
			gainNode.gain.setTargetAtTime(0, context.currentTime, 0.015);
			setTimeout(function() {
				oscillator.stop();
				secondIsPlaying = false;
			}, 40);
		}, false);		
	})();
&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;There’s no more click. We are all happy.&lt;/p&gt;

&lt;h3 id=&quot;using-exponentialramptovalueattime-to-remove-the-click&quot;&gt;Using exponentialRampToValueAtTime to remove the click&lt;/h3&gt;

&lt;p&gt;Since we are at it, let’s see how it would’ve turned out using &lt;code class=&quot;highlighter-rouge&quot;&gt;exponentialRampToValueAtTime&lt;/code&gt; - which I found to be a bit trickier.&lt;/p&gt;

&lt;p&gt;One gotcha is this part of the Web Audio specification:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;(exponentialRampToValueAtTime) Schedules an exponential continuous change in parameter value &lt;strong&gt;from the previous scheduled parameter value&lt;/strong&gt; to the given value.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;From the previous scheduled parameter value&lt;/em&gt; means that you must first set the audioParam with an automation method before using the ramping function. This usually means using &lt;code class=&quot;highlighter-rouge&quot;&gt;setValueAtTime()&lt;/code&gt; instead of setting the audioParam value directly (in other words, don’t do this: &lt;code class=&quot;highlighter-rouge&quot;&gt;gainNode.gain.value = someValue&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Another gotcha also described in the spec:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;It is an error if either V0 or V1 is not strictly positive. This also implies &lt;strong&gt;an exponential ramp to 0 is not possible.&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So we must choose a tiny value, but not zero. As mentioned earlier, we can’t ramp to zero. Also, this time we will use 30 milliseconds as the time for the ramp to occur (this is the total transition time, not the decay time used in &lt;code class=&quot;highlighter-rouge&quot;&gt;setTargetAtTime&lt;/code&gt;).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;AudioContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createOscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createGain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;destination&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;oscillator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;stopButton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'click'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Important! Setting a scheduled parameter value&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setValueAtTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 

    &lt;span class=&quot;nx&quot;&gt;gainNode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;gain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exponentialRampToValueAtTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;button class=&quot;button stop-button&quot; id=&quot;3-stop-button&quot;&gt;&lt;/button&gt;
&lt;button class=&quot;button play-button&quot; id=&quot;3-play-button&quot;&gt;&lt;/button&gt;
&lt;script&gt;
	var gainNode;
	var thirdIsPlaying;
	(function() {
		document.getElementById('3-play-button').addEventListener('click', function() {
			if(thirdIsPlaying) return;
			gainNode = context.createGain();
			oscillator = context.createOscillator();
			oscillator.connect(gainNode);
			gainNode.connect(context.destination);
			oscillator.start();
			thirdIsPlaying = true;
		}, false);
		document.getElementById('3-stop-button').addEventListener('click', function() {
			if (!thirdIsPlaying) return;
			gainNode.gain.setValueAtTime(gainNode.gain.value, context.currentTime);
			gainNode.gain.exponentialRampToValueAtTime(0.0001, context.currentTime + 0.03);
			setTimeout(function() {
				oscillator.stop();
				thirdIsPlaying = false;
			}, 30);
		}, false);		
	})();
&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;Also works, we’ve gotten rid of the click.&lt;/p&gt;

&lt;h2 id=&quot;more-info&quot;&gt;More info&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.audiocheck.net/soundtests_nonlinear.php&quot;&gt;The non-linearities of the human ear&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.w3.org/TR/webaudio/#AudioParam&quot;&gt;The AudioParam interface&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime&quot;&gt;Mozilla’s documentation for setTargetAtTime&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/exponentialRampToValueAtTime&quot;&gt;Mozilla’s documentation for exponentialRampToValueAtTime&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="Web audio" /><category term="JS" /><summary type="html">While playing around with a Web Audio demo, I noticed a clicking sound every time a I stopped an oscillator. Is there a way to avoid it?</summary></entry></feed>